<div class="dashboard-container">
  <!-- Header con información del usuario -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="user-info">
        <div class="user-avatar">
          <img [src]="currentUser?.avatarUrl || '/assets/default-avatar.svg'" 
               [alt]="currentUser?.name" 
               class="avatar-img">
        </div>
        <div class="user-details">
          <h2>Bienvenido, {{currentUser?.name}}</h2>
          <p>{{currentUser?.email}}</p>
        </div>
      </div>
      <!-- <button class="logout-btn" (click)="logout()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16,17 21,12 16,7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
        Cerrar Sesión
      </button> -->
    </div>
  </header>

  <main class="dashboard-main">
    <div class="container">
      <h1 class="main-title">Signature App</h1>
      <p class="main-subtitle">Generación y consulta de llaves criptográficas</p>

      <!-- Sección de Generación de Llaves -->
      <section class="section">
        <div class="card">
          <h2>Generar Par de Llaves</h2>
          <p class="description">Genera un par de llaves pública y privada. La llave privada se descargará automáticamente.</p>
          
          <form [formGroup]="generateForm" (ngSubmit)="generateKeyPair()" class="form">
            <div class="form-group">
              <label for="generateAlias">Alias:</label>
              <input 
                type="text" 
                id="generateAlias"
                formControlName="alias"
                placeholder="Ingresa un alias único"
                class="form-input"
                [class.error]="generateForm.get('alias')?.invalid && generateForm.get('alias')?.touched">
              <div class="error-message" *ngIf="generateForm.get('alias')?.invalid && generateForm.get('alias')?.touched">
                <span *ngIf="generateForm.get('alias')?.errors?.['required']">El alias es requerido</span>
                <span *ngIf="generateForm.get('alias')?.errors?.['minlength']">El alias debe tener al menos 3 caracteres</span>
              </div>
            </div>
            
            <button 
              type="submit" 
              class="btn btn-primary"
              [disabled]="generateForm.invalid || isGenerating">
              <span *ngIf="isGenerating" class="loader"></span>
              {{isGenerating ? 'Generando...' : 'Generar Llaves'}}
            </button>
          </form>

          <div class="message success" *ngIf="generateMessage && !generateMessage.includes('Error')">
            {{generateMessage}}
          </div>
          <div class="message error" *ngIf="generateMessage && generateMessage.includes('Error')">
            {{generateMessage}}
          </div>
        </div>
      </section>

      <!-- Sección de Consulta de Llave Pública -->
      <section class="section">
        <div class="card">
          <h2>Consultar Llave Pública</h2>
          <p class="description">Consulta la llave pública asociada a un alias existente.</p>
          
          <form [formGroup]="consultForm" (ngSubmit)="consultPublicKey()" class="form">
            <div class="form-group">
              <label for="consultAlias">Alias:</label>
              <input 
                type="text" 
                id="consultAlias"
                formControlName="alias"
                placeholder="Ingresa el alias de la llave"
                class="form-input"
                [class.error]="consultForm.get('alias')?.invalid && consultForm.get('alias')?.touched">
              <div class="error-message" *ngIf="consultForm.get('alias')?.invalid && consultForm.get('alias')?.touched">
                <span *ngIf="consultForm.get('alias')?.errors?.['required']">El alias es requerido</span>
                <span *ngIf="consultForm.get('alias')?.errors?.['minlength']">El alias debe tener al menos 3 caracteres</span>
              </div>
            </div>
            
            <button 
              type="submit" 
              class="btn btn-secondary"
              [disabled]="consultForm.invalid || isConsulting">
              <span *ngIf="isConsulting" class="loader"></span>
              {{isConsulting ? 'Consultando...' : 'Consultar Llave'}}
            </button>
          </form>

          <div class="message success" *ngIf="consultMessage && !consultMessage.includes('Error')">
            {{consultMessage}}
          </div>
          <div class="message error" *ngIf="consultMessage && consultMessage.includes('Error')">
            {{consultMessage}}
          </div>

          <div class="public-key-result" *ngIf="publicKey">
            <h3>Llave Pública:</h3>
            <pre class="key-display">{{publicKey}}</pre>
          </div>
        </div>
      </section>
    </div>
  </main>
</div>